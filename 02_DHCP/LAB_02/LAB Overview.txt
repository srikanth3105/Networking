Lab Overview
This lab involves configuring DHCP on Router1 to allocate IP addresses to PCs on VLANs 10 and 20, ensuring that all devices can communicate with each other and the loopback address of Router1. The topology is as follows:

Router1 is connected to Switch1 via GigabitEthernet0/0/0.
PC1 is connected to Switch1 on port Gig1/0/2.
PC2 is connected to Switch1 on port Gig1/0/3.
Steps and Key Configurations
Router Configuration

1.Exclude First 10 IP Addresses in Each Subnet:

This ensures the first 10 IP addresses in each subnet are not allocated by the DHCP server.

R1(config)#ip dhcp excluded-address 10.1.10.1 10.1.10.10
R1(config)#ip dhcp excluded-address 10.1.20.1 10.1.20.10

2.Create DHCP Pools:

Define DHCP pools for VLAN10 and VLAN20.

R1(config)#ip dhcp pool Vlan10
R1(dhcp-config)#network 10.1.10.0 255.255.255.0
R1(dhcp-config)#default-router 10.1.10.1
R1(dhcp-config)#dns-server 10.1.1.254
R1(dhcp-config)#exit
R1(config)#ip dhcp pool Vlan20
R1(dhcp-config)#network 10.1.20.0 255.255.255.0
R1(dhcp-config)#default-router 10.1.20.1
R1(dhcp-config)#dns-server 10.1.1.254

3. Configure Static Routes:

Ensure Router1 can route traffic to the subnets.

R1(config)#ip route 10.1.10.0 255.255.255.0 10.1.1.1
R1(config)#ip route 10.1.20.0 255.255.255.0 10.1.1.1


Switch Configuration
1. Assign VLANs and IP Addresses:

Assign VLANs to ports and configure IP addresses for VLAN interfaces.

S1(config)#interface Vlan1
S1(config-if)#ip address 10.1.1.1 255.255.255.0
S1(config-if)#exit
S1(config)#interface Vlan10
S1(config-if)#ip address 10.1.10.1 255.255.255.0
S1(config-if)#exit
S1(config)#interface Vlan20
S1(config-if)#ip address 10.1.20.1 255.255.255.0


2. Enable IP Routing:

Allow the switch to route traffic between VLANs.

S1(config)#ip routing

3.Configure Static Routes to the Router:

Ensure Switch1 knows how to route traffic to the router's loopback address.

S1(config)#ip route 1.1.1.1 255.255.255.255 10.1.1.254



4.Configure DHCP Relay (IP Helper Address):

Forward DHCP requests from VLANs to the DHCP server (Router1).

S1(config)#interface Vlan10
S1(config-if)#ip helper-address 10.1.1.254
S1(config-if)#exit
S1(config)#interface Vlan20
S1(config-if)#ip helper-address 10.1.1.254

Testing and Verification

1.Verify DHCP Bindings:

Ensure that PCs are getting IP addresses from the DHCP server.

R1#sh ip dhcp binding 

2.Ping Tests:

Verify connectivity between PCs and Router1’s loopback address.
PC1> ping 10.1.20.11 (PC2)
PC2> ping 10.1.10.11 (PC1)
PC1> ping 1.1.1.1 (Router1 loopback)
more

Summary
-Router Configuration: Set up DHCP pools for VLAN10 and VLAN20, excluded initial 10 IP addresses, configured static routes.
-Switch Configuration: Assigned VLANs to ports, configured VLAN interfaces with IP addresses, enabled IP routing, configured static routes, and set up DHCP relay.
-Verification: Ensured PCs received IP addresses via DHCP and confirmed network connectivity through ping tests.

Lab Question
since we are exluding first 10 ip address of VLANS

why below was configured?

S1(config)#interface Vlan10
S1(config-if)#ip address 10.1.10.1 255.255.255.0
S1(config-if)#exit
S1(config)#interface Vlan20
S1(config-if)#ip address 10.1.20.1 255.255.255.0

The reason why the switch interfaces for VLAN10 and VLAN20 were configured with the IP addresses 10.1.10.1 and 10.1.20.1 respectively, even though the first 10 IP addresses of these subnets are excluded from DHCP allocation, is as follows:

Gateway Addresses:

The IP addresses 10.1.10.1 and 10.1.20.1 are configured on the switch to act as the default gateways for devices on VLAN10 and VLAN20. This allows devices within each VLAN to send traffic to other subnets through the switch.
Router-On-A-Stick:

In a router-on-a-stick configuration, the router is configured with subinterfaces for each VLAN. Each subinterface needs an IP address within the respective VLAN’s subnet to route traffic between VLANs. These addresses (10.1.10.1 and 10.1.20.1) serve as the router's subinterface addresses in this setup.
DHCP Exclusion:

The excluded addresses (e.g., 10.1.10.1 to 10.1.10.10) ensure that the DHCP server does not allocate these addresses to clients. This prevents IP address conflicts and ensures that critical addresses (such as the gateway) remain static and known.

Detailed Explanation
1. Switch Configuration for VLAN10 and VLAN20:

The switch is configured with IP addresses for VLAN10 and VLAN20 interfaces. These IP addresses are used by devices on these VLANs as their default gateway.

S1(config)#interface Vlan10
S1(config-if)#ip address 10.1.10.1 255.255.255.0
S1(config-if)#exit
S1(config)#interface Vlan20
S1(config-if)#ip address 10.1.20.1 255.255.255.0

2.Exclusion of Addresses in Router:

The router excludes the first 10 IP addresses in each VLAN subnet from being allocated by DHCP.

R1(config)#ip dhcp excluded-address 10.1.10.1 10.1.10.10
R1(config)#ip dhcp excluded-address 10.1.20.1 10.1.20.10


By excluding the first 10 IP addresses from DHCP allocation, we ensure that 10.1.10.1 and 10.1.20.1 can be used as the static gateway addresses without any conflict from dynamically assigned addresses. These gateway addresses are critical for routing traffic between VLANs and to the external network.